---
title: "Introduction to visa"
author: "Kang Yu"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette 
vignette: >
  %\VignetteIndexEntry{Introduction to visa}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
fig_caption: yes
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

Imaging Spectroscopy (also knowns as Hyperspectral Remote Sensing, HRS) technology and data are increasingly used in environmental sciences, and nowadays much more beyond that, thus requiring accessable data and analytical tools (especially open source) for students and scientists with a diverse background. Therefore, I come up with such a idea since i was a PhD student at the University of Cologne, inspired by the growing community of R and R users. I have been mainly working with spectral data of plants, and that is reason i use the name VISA for this package, with the aim to facilitate the use of imaging spectroscopy techniques and data for the extraction of vegetation signatures for plant stresses and biodiversity.

Future development of this tool has a long-term goal to include: i) implement the state-of-the-art applications of vegetation spectral indicators, ii) provide a platform to share vegetation spectral data to address certain questions of interest or applications in a broad context. Currently, `visa` can be installed via my [GitHub repository visa](https://github.com/kang-yu/visa), and submission to CRAN is in progress.

This vignette will introduces the design and features of `visa` from the following aspects:

- Data format
- Functions 
- Compatibility

## Vignette Info

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.

## Correlation matrix

The first idea of writing this package was to compute the correlation matrix for the thorough analysis of correlations between, on one hand, the combinations of spectral bands, and on the other hand, the vegetation variables of interest. 

Here gives the example using the `cm.nsr` function, which can be used for non-spectra data as well.

```{r, echo=TRUE, warning=FALSE}
library(visa)
data(NSpec.DF)
x <- NSpec.DF$N # nitrogen
S <- NSpec.DF$spectra[, seq(1, ncol(NSpec.DF$spectra), 10)] # resampled to 10 nm steps
cm <- cm.nsr(S, x, cm.plot = TRUE)
```


## Plotting correlation matrix

The correlation matrix plot is the plot of correlation coefficients (r/r2) by bands in x- and y-axis. 

```{r, fig.show='hold', fig.cap = "Plot of correlation matrix"}
# use the output from last example
# cm <- cm.nsr(S, x, cm.plot = TRUE)
# Plotting the correlation matrix
visa::plot.cm(cm)

```


## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

The package `visa` comes with example hyperspectral data, in two types of format.  

### Example data `NSpec.DB`

 The first typle is the 'NSpec.DB' in the default S4 class 'Spctra'.

```{r, echo=TRUE, results='asis'}
library(visa)
# check the data type
class(NSpec.DB) 
# data structure
# str(NSpec.DB)
# print the first 10 columns
knitr::kable(head(NSpec.DB@spectra[,1:10]))
```

### Example data `NSpec.DF`

The second typle is a data.frame format, i.e., `NSpec.DF`.

```{r, echo=TRUE, results='asis'}
str(NSpec.DF) 
# check whether it contains the same data as 'NSpec.DB'
knitr::kable(head(NSpec.DF$spectra[,1:10]))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
